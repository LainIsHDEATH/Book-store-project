<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title th:text="#{orders.my.title.page}">My Orders</title>
    <link rel="icon" type="image/svg+xml" th:href="@{/favicon.svg}">
    <link rel="stylesheet" th:href="@{/css/book-list-form.css}">
</head>
<body>
<div th:insert="~{fragments/navbar :: topbar}"></div>

<div class="container">

    <div class="page-head">
        <h1 class="title" th:text="#{orders.my.title.page}">My orders</h1>
        <a class="btn btn-ghost" th:href="@{/}" th:text="#{orders.my.action.continueShopping}">
            Continue shopping
        </a>
    </div>

    <!-- empty -->
    <div class="card" th:if="${#lists.isEmpty(orders)}">
        <div class="card-body">
            <div class="muted" th:text="#{orders.my.empty}">No orders yet.</div>
        </div>
    </div>

    <!-- not empty -->
    <table class="table" th:if="${!#lists.isEmpty(orders)}">
        <thead>
        <tr>
            <th style="width:120px;" th:text="#{orders.my.table.order}">Order</th>
            <th style="width:220px;" th:text="#{orders.my.table.date}">Date</th>
            <th style="width:160px;" th:text="#{orders.my.table.status}">Status</th>
            <th style="width:160px;" th:text="#{orders.my.table.total}">Total</th>
            <th style="width:220px;" th:text="#{orders.my.table.action}">Action</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="o : ${orders}">
            <td>
                <a th:href="@{/orders/{id}(id=${o.orderId})}"
                   th:text="'#' + ${o.orderId}">
                    #1
                </a>
            </td>

            <td>
                <div th:text="${#temporals.format(o.orderDate, 'dd.MM.yyyy HH:mm')}">date</div>

                <div class="muted" th:if="${o.employeeEmail != null}">
                    <span th:text="#{orders.my.employee}">Employee</span>:
                    <span th:text="${o.employeeEmail}">emp</span>
                </div>
            </td>

            <td>
                <span class="badge"
                      th:classappend="${o.status.name() == 'PAID'} ? ' badge-paid' : ' badge-canceled'"
                      th:text="#{orderStatus.__${o.status}__}">
                    PAID
                </span>
            </td>

            <td>
                <b th:text="${o.price}">0</b>
                <span th:text="#{currency.uah}">â‚´</span>
            </td>

            <td class="actions">
                <a class="btn btn-ghost"
                   th:href="@{/orders/{id}(id=${o.orderId})}"
                   th:text="#{action.view}">
                    View
                </a>

                <form th:if="${o.status.name() != 'CANCELED'}"
                      th:action="@{/orders/{id}/cancel(id=${o.orderId})}"
                      method="post"
                      style="display:inline-block; margin:0;">
                    <button class="btn btn-danger" type="submit"
                            th:text="#{action.cancel}"
                            onclick="return confirm(this.getAttribute('data-confirm'));"
                            th:attr="data-confirm=#{orders.my.confirm.cancel}">
                        Cancel
                    </button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

</div>
</body>
</html>