<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Book Store</title>
    <style>
        body { font-family: Arial, sans-serif; background:#f5f6f8; margin:0; }
        .container { max-width: 1100px; margin: 0 auto; padding: 16px; }
        .toolbar { background:#fff; border:1px solid #e3e6ea; padding:12px; border-radius:8px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
        .toolbar input, .toolbar select { padding:8px; border:1px solid #d6dbe1; border-radius:6px; }
        .btn { padding:8px 14px; border-radius:6px; border:1px solid transparent; cursor:pointer; }
        .btn-primary { background:#1976d2; color:#fff; }
        .btn-secondary { background:#e9ecef; color:#000; border-color:#d6dbe1; text-decoration:none; display:inline-block; }
        h2 { text-align:center; margin:18px 0; }
        .grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; }
        .card { background:#fff; border:1px solid #e3e6ea; border-radius:10px; padding:14px; }
        .title { font-weight:700; margin:0 0 4px; }
        .meta { color:#556; font-size: 13px; margin-bottom:10px; }
        .badge { display:inline-block; padding:3px 8px; border-radius:999px; font-size:12px; background:#eef2f6; margin-right:6px; }
        .desc { color:#444; font-size: 13px; min-height: 44px; }
        .price { font-weight:700; color:#1b7f3a; margin:10px 0; }
        .pagination { margin:16px 0; display:flex; justify-content:center; align-items:center; gap:10px; }
        .page-link { padding:6px 10px; border:1px solid #d6dbe1; background:#fff; border-radius:6px; text-decoration:none; color:#000; }
        .page-link.active { background:#1976d2; color:#fff; border-color:#1976d2; }
        @media (max-width: 960px) { .grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 640px) { .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
<div class="container">

    <!-- Панель поиска/фильтров -->
    <form class="toolbar" th:action="@{/}" method="get">
        <input type="text" name="keyword" placeholder="Пошук за назвою/автором"
               th:value="${keyword}" />

        <select name="ageGroup">
            <option value="">Всі вікові групи</option>
            <option th:each="ag : ${ageGroups}"
                    th:value="${ag}"
                    th:selected="${ag == ageGroup}"
                    th:text="${ag}"></option>
        </select>

        <select name="genre">
            <option value="">Всі жанри</option>
            <option th:each="g : ${genres}"
                    th:value="${g}"
                    th:selected="${g == genre}"
                    th:text="${g}"></option>
        </select>

        <select name="originalLanguage">
            <option value="">Всі мови</option>
            <option th:each="l : ${languages}"
                    th:value="${l}"
                    th:selected="${l == originalLanguage}"
                    th:text="${l}"></option>
        </select>

        <button class="btn btn-primary" type="submit">Знайти</button>
        <a class="btn btn-secondary" th:href="@{/}">Скинути</a>
    </form>

    <h2>Доступні книги</h2>

    <!-- Карточки книг -->
    <div class="grid">
        <div class="card" th:each="b : ${books.content}">
            <div class="title"
                 th:text="${#locale.language == 'uk' ? b.nameUa : b.nameEn}">
                Назва
            </div>

            <div class="meta">
                <span th:text="${#locale.language == 'uk' ? b.author.nameUa : b.author.nameEn}">Автор</span>
                • <span th:text="${#temporals.format(b.publishDate, 'dd.MM.yyyy')}">date</span>
            </div>

            <div>
                <span class="badge" th:text="${b.genre}">GENRE</span>
                <span class="badge" th:text="${b.originalLanguage}">LANG</span>
                <span class="badge" th:text="${b.ageGroup}">AGE</span>
            </div>

            <div class="price" th:text="${b.price} + ' ₴'">0 ₴</div>

            <div class="desc"
                 th:text="${#locale.language == 'uk' ? b.descriptionUa : b.descriptionEn}">
                Опис...
            </div>

            <!-- Кнопку "Додати в кошик" добавишь позже (когда подключишь корзину) -->
            <!--
            <form th:action="@{/cart/items}" method="post">
              <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
              <input type="hidden" name="bookId" th:value="${b.id}"/>
              <button class="btn btn-primary" type="submit">Додати в кошик</button>
            </form>
            -->
        </div>
    </div>

    <!-- Пагинация -->
    <div class="pagination" th:if="${books.totalPages > 1}">
        <a class="page-link" th:if="${books.hasPrevious()}"
           th:href="@{/(page=${books.number-1}, keyword=${keyword}, ageGroup=${ageGroup}, genre=${genre}, originalLanguage=${originalLanguage})}">
            Попередня
        </a>

        <a class="page-link"
           th:each="p : ${#numbers.sequence(0, books.totalPages-1)}"
           th:classappend="${p == books.number} ? ' active' : ''"
           th:text="${p + 1}"
           th:href="@{/(page=${p}, keyword=${keyword}, ageGroup=${ageGroup}, genre=${genre}, originalLanguage=${originalLanguage})}">
        </a>

        <a class="page-link" th:if="${books.hasNext()}"
           th:href="@{/(page=${books.number+1}, keyword=${keyword}, ageGroup=${ageGroup}, genre=${genre}, originalLanguage=${originalLanguage})}">
            Наступна
        </a>
    </div>

    <div style="text-align:center; color:#556; margin-top:8px;">
        Сторінка <span th:text="${books.number + 1}"></span> / <span th:text="${books.totalPages}"></span>
        • Всього: <span th:text="${books.totalElements}"></span>
    </div>

</div>
</body>
</html>